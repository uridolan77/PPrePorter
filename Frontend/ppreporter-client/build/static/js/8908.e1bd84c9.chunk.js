"use strict";(self.webpackChunkppreporter_client=self.webpackChunkppreporter_client||[]).push([[8908],{28395:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var l=a(65043),n=a(19252),i=a(85865),r=a(63336),s=a(11906),o=a(8591),d=a(53193),c=a(18356),h=a(72221),u=a(32143),A=a(30279),x=a(39336),y=a(12110),m=a(26494),v=a(83462),g=a(4219),p=a(35316),j=a(29347),f=a(81637),b=a(88696),w=a(92317),I=a(352),C=a(69525),N=a(58390),F=a(40672),S=a(82746),D=a(28242),E=a(41132),P=a(21337),L=a(85473),G=a(85440),M=a(12807),R=a(70579);const k=()=>{const[e,t]=(0,l.useState)(new Date((new Date).setDate((new Date).getDate()-30))),[a,k]=(0,l.useState)(new Date),[B,W]=(0,l.useState)([]),[z,T]=(0,l.useState)([]),[H,U]=(0,l.useState)("day"),[O,V]=(0,l.useState)(!1),[$,_]=(0,l.useState)({}),[q,X]=(0,l.useState)([]),[Z,J]=(0,l.useState)(null),[K,Q]=(0,l.useState)(!1),[Y,ee]=(0,l.useState)(null),[te,ae]=(0,l.useState)(0),[le,ne]=(0,l.useState)([]),[ie,re]=(0,l.useState)([]),[se,oe]=(0,l.useState)(!1),[de,ce]=(0,l.useState)(!1),[he,ue]=(0,l.useState)([]),[Ae,xe]=(0,l.useState)([]),[ye,me]=(0,l.useState)(0),[ve,ge]=(0,l.useState)(10),[pe,je]=(0,l.useState)("date"),[fe,be]=(0,l.useState)("desc"),[we,Ie]=(0,l.useState)(!1),[Ce,Ne]=(0,l.useState)("excel");(0,l.useEffect)((()=>{(async()=>{try{console.log("[FINANCIAL PAGE] Fetching metadata"),oe(!0),ce(!0);const e=await G.A.financial.getMetadata();if(console.log("[FINANCIAL PAGE] Got metadata from service:",e),e&&e.whiteLabels){console.log("[FINANCIAL PAGE] Got white labels from service:",e.whiteLabels);const t=e.whiteLabels||[];ne(t);const a=t.map((e=>({value:e.id,label:e.name})));ue(a)}else console.log("[FINANCIAL PAGE] No white labels found in API response"),ne([]),ue([]);if(oe(!1),e&&e.countries){console.log("[FINANCIAL PAGE] Got countries from service:",e.countries);const t=e.countries||[];re(t);const a=t.map((e=>({value:e.id,label:e.name})));xe(a)}else console.log("[FINANCIAL PAGE] No countries found in API response"),re([]),xe([]);ce(!1)}catch(e){console.error("[FINANCIAL PAGE] Error fetching metadata:",e),ee("Failed to load metadata. Please try again later.")}})()}),[]),(0,l.useEffect)((()=>{const e=setTimeout((()=>{(async()=>{console.log("[FINANCIAL PAGE] Fetching initial data"),await Fe()})()}),100);return()=>clearTimeout(e)}),[]);const Fe=async()=>{try{Q(!0),ee(null);const n={startDate:(0,C.A)(e,"yyyy-MM-dd"),endDate:(0,C.A)(a,"yyyy-MM-dd"),whiteLabelIds:B.length>0?B.map((e=>String(e))):void 0,countryIds:z.length>0?z.map((e=>String(e))):void 0,groupBy:H,...$};console.log("[FINANCIAL PAGE] Fetching data with filters:",n);const i={page:ye+1,pageSize:ve,sortBy:pe,sortDirection:fe},r=await G.A.financial.getData({...n,...i});var t;if(r&&r.data)if(X(r.data),ae((null===(t=r.meta)||void 0===t?void 0:t.totalCount)||r.data.length),r.summary)console.log("[FINANCIAL PAGE] Using summary from response:",r.summary),J(r.summary);else try{const e=await G.A.financial.getSummary(n);e&&J(e)}catch(l){console.error("[FINANCIAL PAGE] Error fetching summary:",l)}else console.log("[FINANCIAL PAGE] No data returned from API"),X([]),J(null),ae(0)}catch(n){console.error("[FINANCIAL PAGE] Error fetching data:",n),ee("Failed to load financial data. Please try again later."),X([]),J(null),ae(0)}finally{Q(!1)}},Se=[{id:"date",label:"Date",type:"date",align:"left",format:e=>(0,C.A)(new Date(e),"yyyy-MM-dd")},{id:"whiteLabelName",label:"White Label",type:"text",align:"left"},{id:"revenue",label:"Revenue",type:"currency",align:"right",format:e=>(0,M.vv)(e)},{id:"ggr",label:"GGR",type:"currency",align:"right",format:e=>(0,M.vv)(e)},{id:"ngr",label:"NGR",type:"currency",align:"right",format:e=>(0,M.vv)(e)},{id:"deposits",label:"Deposits",type:"currency",align:"right",format:e=>(0,M.vv)(e)},{id:"withdrawals",label:"Withdrawals",type:"currency",align:"right",format:e=>(0,M.vv)(e)},{id:"netDeposits",label:"Net Deposits",type:"currency",align:"right",format:e=>(0,M.vv)(e)},{id:"bonusAmount",label:"Bonus Amount",type:"currency",align:"right",format:e=>(0,M.vv)(e||0)},{id:"netProfit",label:"Net Profit",type:"currency",align:"right",format:e=>(0,M.vv)(e||0)}];return(0,R.jsxs)(n.A,{maxWidth:"xl",children:[(0,R.jsx)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,R.jsxs)("div",{children:[(0,R.jsx)(i.A,{variant:"h4",gutterBottom:!0,children:"Financial Report"}),(0,R.jsx)(i.A,{variant:"body1",color:"text.secondary",children:"View and analyze financial data, revenue, and profitability metrics"})]})}),(0,R.jsxs)(r.A,{sx:{p:3,mb:4},children:[(0,R.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,R.jsx)(i.A,{variant:"h6",children:"Filters"}),(0,R.jsxs)("div",{children:[(0,R.jsx)(s.A,{variant:"outlined",color:"primary",onClick:()=>V(!O),startIcon:O?(0,R.jsx)(L.A,{}):(0,R.jsx)(P.A,{}),sx:{mr:1},children:O?"Hide Advanced Filters":"Show Advanced Filters"}),(0,R.jsx)(s.A,{variant:"outlined",color:"secondary",onClick:()=>{t(new Date((new Date).setDate((new Date).getDate()-30))),k(new Date),W([]),T([]),U("day"),_({}),me(0),je("date"),be("desc")},sx:{mr:1},children:"Reset"}),(0,R.jsx)(s.A,{variant:"contained",color:"primary",onClick:()=>{me(0),Fe()},startIcon:(0,R.jsx)(D.A,{}),children:"Apply Filters"})]})]}),(0,R.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(N.$,{dateAdapter:F.h,children:(0,R.jsx)(S.l,{label:"Start Date",value:e,onChange:e=>e&&t(e),slotProps:{textField:{fullWidth:!0,variant:"outlined"}}})})}),(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(N.$,{dateAdapter:F.h,children:(0,R.jsx)(S.l,{label:"End Date",value:a,onChange:e=>e&&k(e),slotProps:{textField:{fullWidth:!0,variant:"outlined"}}})})}),(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsxs)(d.A,{fullWidth:!0,variant:"outlined",children:[(0,R.jsx)(c.A,{id:"group-by-label",children:"Group By"}),(0,R.jsxs)(h.A,{labelId:"group-by-label",value:H,onChange:e=>U(e.target.value),label:"Group By",children:[(0,R.jsx)(u.A,{value:"day",children:"Day"}),(0,R.jsx)(u.A,{value:"week",children:"Week"}),(0,R.jsx)(u.A,{value:"month",children:"Month"}),(0,R.jsx)(u.A,{value:"whiteLabel",children:"White Label"}),(0,R.jsx)(u.A,{value:"country",children:"Country"})]})]})}),(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(I.A,{label:"White Labels",options:he,value:B,onChange:W,loading:se,fullWidth:!0})})]}),(0,R.jsx)(A.A,{in:O,children:(0,R.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,R.jsx)(x.A,{sx:{my:2}}),(0,R.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"Advanced Filters"}),(0,R.jsx)(o.Ay,{container:!0,spacing:2,children:(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(I.A,{label:"Countries",options:Ae,value:z,onChange:T,loading:de,fullWidth:!0})})})]})})]}),Z&&(0,R.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(y.A,{children:(0,R.jsxs)(m.A,{children:[(0,R.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total Revenue"}),(0,R.jsx)(i.A,{variant:"h5",children:(0,M.vv)(Z.totalRevenue)})]})})}),(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(y.A,{children:(0,R.jsxs)(m.A,{children:[(0,R.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total GGR"}),(0,R.jsx)(i.A,{variant:"h5",children:(0,M.vv)(Z.totalGGR)})]})})}),(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(y.A,{children:(0,R.jsxs)(m.A,{children:[(0,R.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total NGR"}),(0,R.jsx)(i.A,{variant:"h5",children:(0,M.vv)(Z.totalNGR)})]})})}),(0,R.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,R.jsx)(y.A,{children:(0,R.jsxs)(m.A,{children:[(0,R.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Net Profit"}),(0,R.jsx)(i.A,{variant:"h5",children:(0,M.vv)(Z.totalNetProfit||0)})]})})})]}),(0,R.jsx)(r.A,{sx:{p:0,mb:4,overflow:"hidden"},children:(0,R.jsx)(b.zZ,{columns:Se,data:q,loading:K,title:"Financial Data",emptyMessage:"No financial data available",idField:"id",onExport:e=>{Ne(e),Ie(!0)},features:{sorting:!0,filtering:{enabled:!0,quickFilter:!0,advancedFilter:!0},pagination:{enabled:!0,defaultPageSize:ve,pageSizeOptions:[10,25,50,100]},columnManagement:{enabled:!0,allowReordering:!0,allowHiding:!0,allowResizing:!0},export:{enabled:!0,formats:[w.A.CSV,w.A.EXCEL,w.A.PDF]}}})}),(0,R.jsxs)(v.A,{open:we,onClose:()=>Ie(!1),children:[(0,R.jsx)(g.A,{children:"Export Financial Data"}),(0,R.jsxs)(p.A,{children:[(0,R.jsx)(i.A,{variant:"body1",paragraph:!0,children:"Please confirm that you want to export the financial data with the current filters."}),(0,R.jsxs)(d.A,{fullWidth:!0,sx:{mt:2},children:[(0,R.jsx)(c.A,{id:"export-format-label",children:"Export Format"}),(0,R.jsxs)(h.A,{labelId:"export-format-label",value:Ce,onChange:e=>Ne(e.target.value),label:"Export Format",children:[(0,R.jsx)(u.A,{value:"excel",children:"Excel"}),(0,R.jsx)(u.A,{value:"csv",children:"CSV"}),(0,R.jsx)(u.A,{value:"pdf",children:"PDF"})]})]})]}),(0,R.jsxs)(j.A,{children:[(0,R.jsx)(s.A,{onClick:()=>Ie(!1),children:"Cancel"}),(0,R.jsx)(s.A,{onClick:async()=>{try{Q(!0);const t={startDate:(0,C.A)(e,"yyyy-MM-dd"),endDate:(0,C.A)(a,"yyyy-MM-dd"),whiteLabelIds:B.length>0?B.map((e=>String(e))):void 0,countryIds:z.length>0?z.map((e=>String(e))):void 0,groupBy:H,...$},l=await G.A.financial.exportData(t,Ce),n=window.URL.createObjectURL(l),i=document.createElement("a");i.href=n,i.download=`financial-report-${(0,C.A)(new Date,"yyyy-MM-dd")}.${Ce}`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(n),document.body.removeChild(i),Ie(!1)}catch(t){console.error("[FINANCIAL PAGE] Error exporting data:",t),ee("Failed to export data. Please try again later.")}finally{Q(!1)}},variant:"contained",color:"primary",startIcon:(0,R.jsx)(E.A,{}),disabled:K,children:K?(0,R.jsx)(f.A,{size:24}):"Export"})]})]})]})}},41132:(e,t,a)=>{var l=a(24994);t.A=void 0;var n=l(a(40039)),i=a(70579);t.A=(0,n.default)((0,i.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")},47030:(e,t,a)=>{var l=a(24994);t.A=void 0;var n=l(a(40039)),i=a(70579);t.A=(0,n.default)((0,i.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined")}}]);
//# sourceMappingURL=8908.e1bd84c9.chunk.js.map