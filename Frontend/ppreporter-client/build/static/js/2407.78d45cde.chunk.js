"use strict";(self.webpackChunkppreporter_client=self.webpackChunkppreporter_client||[]).push([[2407],{62407:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var r=a(65043),n=a(19252),i=a(85865),l=a(63336),s=a(11906),o=a(8591),c=a(53193),d=a(18356),h=a(72221),x=a(32143),y=a(30279),u=a(39336),g=a(12110),m=a(26494),j=a(81637),p=a(83462),A=a(4219),v=a(35316),b=a(29347),f=a(88696),w=a(92317),G=a(352),C=a(69525),S=a(58390),E=a(40672),P=a(82746),D=a(28242),F=a(41132),I=a(21337),R=a(85473),k=a(85440),N=a(12807),B=a(86039),L=a(70579);const M=()=>{const[e,t]=(0,r.useState)(new Date((new Date).setDate((new Date).getDate()-30))),[a,M]=(0,r.useState)(new Date),[O,H]=(0,r.useState)([]),[K,W]=(0,r.useState)([]),[T,$]=(0,r.useState)("country"),[z,U]=(0,r.useState)(!1),[V,Z]=(0,r.useState)({}),[_,q]=(0,r.useState)([]),[Q,X]=(0,r.useState)(null),[J,Y]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(null),[ae,re]=(0,r.useState)(0),[ne,ie]=(0,r.useState)([]),[le,se]=(0,r.useState)([]),[oe,ce]=(0,r.useState)([]),[de,he]=(0,r.useState)([]),[xe,ye]=(0,r.useState)(!1),[ue,ge]=(0,r.useState)(!1),[me,je]=(0,r.useState)([]),[pe,Ae]=(0,r.useState)([]),[ve,be]=(0,r.useState)(0),[fe,we]=(0,r.useState)(10),[Ge,Ce]=(0,r.useState)("players"),[Se,Ee]=(0,r.useState)("desc"),[Pe,De]=(0,r.useState)(!1),[Fe,Ie]=(0,r.useState)("excel");(0,r.useEffect)((()=>{(async()=>{try{console.log("[GEOGRAPHIC PAGE] Fetching metadata"),ye(!0),ge(!0);const e=await k.A.geographic.getMetadata();if(console.log("[GEOGRAPHIC PAGE] Got metadata from service:",e),e&&e.countries){console.log("[GEOGRAPHIC PAGE] Got countries from service:",e.countries);const t=e.countries||[];ie(t);const a=t.map((e=>({value:e.id,label:e.name})));je(a)}else console.log("[GEOGRAPHIC PAGE] No countries found in API response"),ie([]),je([]);if(ye(!1),e&&e.whiteLabels){console.log("[GEOGRAPHIC PAGE] Got white labels from service:",e.whiteLabels);const t=e.whiteLabels||[];se(t);const a=t.map((e=>({value:e.id,label:e.name})));Ae(a)}else console.log("[GEOGRAPHIC PAGE] No white labels found in API response"),se([]),Ae([]);ge(!1),e&&e.regions&&ce(e.regions),e&&e.continents&&he(e.continents)}catch(e){console.error("[GEOGRAPHIC PAGE] Error fetching metadata:",e),te("Failed to load metadata. Please try again later.")}})()}),[]),(0,r.useEffect)((()=>{const e=setTimeout((()=>{(async()=>{console.log("[GEOGRAPHIC PAGE] Fetching initial data"),await Re()})()}),100);return()=>clearTimeout(e)}),[]);const Re=async()=>{try{Y(!0),te(null);const n={startDate:(0,C.A)(e,"yyyy-MM-dd"),endDate:(0,C.A)(a,"yyyy-MM-dd"),countryIds:O.length>0?O.map((e=>String(e))):void 0,whiteLabelIds:K.length>0?K.map((e=>String(e))):void 0,groupBy:T,...V};console.log("[GEOGRAPHIC PAGE] Fetching data with filters:",n);const i={page:ve+1,pageSize:fe,sortBy:Ge,sortDirection:Se},l=await k.A.geographic.getData({...n,...i});var t;if(l&&l.data)if(q(l.data),re((null===(t=l.meta)||void 0===t?void 0:t.totalCount)||l.data.length),l.summary)console.log("[GEOGRAPHIC PAGE] Using summary from response:",l.summary),X(l.summary);else try{const e=await k.A.geographic.getSummary(n);e&&X(e)}catch(r){console.error("[GEOGRAPHIC PAGE] Error fetching summary:",r)}else console.log("[GEOGRAPHIC PAGE] No data returned from API"),q([]),X(null),re(0)}catch(n){console.error("[GEOGRAPHIC PAGE] Error fetching data:",n),te("Failed to load geographic data. Please try again later."),q([]),X(null),re(0)}finally{Y(!1)}},ke=[{id:"countryName",label:"Country",type:"text",align:"left"},{id:"players",label:"Players",type:"number",align:"right",format:e=>(0,N.ZV)(e)},{id:"newPlayers",label:"New Players",type:"number",align:"right",format:e=>(0,N.ZV)(e||0)},{id:"revenue",label:"Revenue",type:"currency",align:"right",format:e=>(0,N.vv)(e)},{id:"ggr",label:"GGR",type:"currency",align:"right",format:e=>(0,N.vv)(e||0)},{id:"deposits",label:"Deposits",type:"currency",align:"right",format:e=>(0,N.vv)(e)},{id:"withdrawals",label:"Withdrawals",type:"currency",align:"right",format:e=>(0,N.vv)(e)},{id:"netDeposits",label:"Net Deposits",type:"currency",align:"right",format:e=>(0,N.vv)(e||0)},{id:"bonusAmount",label:"Bonus Amount",type:"currency",align:"right",format:e=>(0,N.vv)(e||0)},{id:"bets",label:"Bets",type:"number",align:"right",format:e=>(0,N.ZV)(e||0)},{id:"wins",label:"Wins",type:"number",align:"right",format:e=>(0,N.ZV)(e||0)},{id:"winRate",label:"Win Rate",type:"percentage",align:"right",format:e=>(0,N.Ee)(e||0)}];return(0,L.jsxs)(n.A,{maxWidth:"xl",children:[(0,L.jsx)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,L.jsxs)("div",{children:[(0,L.jsx)(i.A,{variant:"h4",gutterBottom:!0,children:"Geographic Report"}),(0,L.jsx)(i.A,{variant:"body1",color:"text.secondary",children:"View and analyze player distribution, revenue, and performance metrics by country"})]})}),(0,L.jsxs)(l.A,{sx:{p:3,mb:4},children:[(0,L.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)(i.A,{variant:"h6",children:"Filters"}),(0,L.jsxs)("div",{children:[(0,L.jsx)(s.A,{variant:"outlined",color:"primary",onClick:()=>U(!z),startIcon:z?(0,L.jsx)(R.A,{}):(0,L.jsx)(I.A,{}),sx:{mr:1},children:z?"Hide Advanced Filters":"Show Advanced Filters"}),(0,L.jsx)(s.A,{variant:"outlined",color:"secondary",onClick:()=>{t(new Date((new Date).setDate((new Date).getDate()-30))),M(new Date),H([]),W([]),$("country"),Z({}),be(0),Ce("players"),Ee("desc")},sx:{mr:1},children:"Reset"}),(0,L.jsx)(s.A,{variant:"contained",color:"primary",onClick:()=>{be(0),Re()},startIcon:(0,L.jsx)(D.A,{}),children:"Apply Filters"})]})]}),(0,L.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(S.$,{dateAdapter:E.h,children:(0,L.jsx)(P.l,{label:"Start Date",value:e,onChange:e=>e&&t(e),slotProps:{textField:{fullWidth:!0,variant:"outlined"}}})})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(S.$,{dateAdapter:E.h,children:(0,L.jsx)(P.l,{label:"End Date",value:a,onChange:e=>e&&M(e),slotProps:{textField:{fullWidth:!0,variant:"outlined"}}})})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsxs)(c.A,{fullWidth:!0,variant:"outlined",children:[(0,L.jsx)(d.A,{id:"group-by-label",children:"Group By"}),(0,L.jsxs)(h.A,{labelId:"group-by-label",value:T,onChange:e=>$(e.target.value),label:"Group By",children:[(0,L.jsx)(x.A,{value:"country",children:"Country"}),(0,L.jsx)(x.A,{value:"region",children:"Region"}),(0,L.jsx)(x.A,{value:"continent",children:"Continent"}),(0,L.jsx)(x.A,{value:"day",children:"Day"}),(0,L.jsx)(x.A,{value:"week",children:"Week"}),(0,L.jsx)(x.A,{value:"month",children:"Month"})]})]})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(G.A,{label:"Countries",options:me,value:O,onChange:H,loading:xe,fullWidth:!0})})]}),(0,L.jsx)(y.A,{in:z,children:(0,L.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,L.jsx)(u.A,{sx:{my:2}}),(0,L.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"Advanced Filters"}),(0,L.jsx)(o.Ay,{container:!0,spacing:2,children:(0,L.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,L.jsx)(G.A,{label:"White Labels",options:pe,value:K,onChange:W,loading:ue,fullWidth:!0})})})]})})]}),Q&&(0,L.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(g.A,{children:(0,L.jsxs)(m.A,{children:[(0,L.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total Players"}),(0,L.jsx)(i.A,{variant:"h5",children:(0,N.ZV)(Q.totalPlayers)})]})})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(g.A,{children:(0,L.jsxs)(m.A,{children:[(0,L.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total Revenue"}),(0,L.jsx)(i.A,{variant:"h5",children:(0,N.vv)(Q.totalRevenue)})]})})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(g.A,{children:(0,L.jsxs)(m.A,{children:[(0,L.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total Deposits"}),(0,L.jsx)(i.A,{variant:"h5",children:(0,N.vv)(Q.totalDeposits)})]})})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,L.jsx)(g.A,{children:(0,L.jsxs)(m.A,{children:[(0,L.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total Withdrawals"}),(0,L.jsx)(i.A,{variant:"h5",children:(0,N.vv)(Q.totalWithdrawals)})]})})})]}),(0,L.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,L.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(l.A,{sx:{p:3,height:"100%"},children:[(0,L.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Player Distribution by Country"}),(0,L.jsx)("div",{style:{height:300},children:J?(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,L.jsx)(j.A,{})}):_.length>0?(0,L.jsx)(B.LL,{data:_&&0!==_.length?[..._].sort(((e,t)=>t.players-e.players)).slice(0,10).map((e=>({name:e.countryName,value:e.players}))):[],nameKey:"name",valueKey:"value",height:300,showLegend:!0}):(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,L.jsx)(i.A,{variant:"body1",color:"text.secondary",children:"No data available"})})})]})}),(0,L.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,L.jsxs)(l.A,{sx:{p:3,height:"100%"},children:[(0,L.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Revenue by Country (Top 10)"}),(0,L.jsx)("div",{style:{height:300},children:J?(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,L.jsx)(j.A,{})}):_.length>0?(0,L.jsx)(B.ML,{data:[..._].sort(((e,t)=>t.revenue-e.revenue)).slice(0,10).map((e=>({country:e.countryName,revenue:e.revenue}))),xKey:"country",yKeys:["revenue"],height:300,showLegend:!1,showGrid:!0}):(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,L.jsx)(i.A,{variant:"body1",color:"text.secondary",children:"No data available"})})})]})})]}),(0,L.jsx)(l.A,{sx:{p:0,mb:4,overflow:"hidden"},children:(0,L.jsx)(f.zZ,{columns:ke,data:_,loading:J,title:"Geographic Data",emptyMessage:"No geographic data available",idField:"id",onExport:e=>{Ie(e),De(!0)},features:{sorting:!0,filtering:{enabled:!0,quickFilter:!0,advancedFilter:!0},pagination:{enabled:!0,defaultPageSize:fe,pageSizeOptions:[10,25,50,100]},columnManagement:{enabled:!0,allowReordering:!0,allowHiding:!0,allowResizing:!0},export:{enabled:!0,formats:[w.A.CSV,w.A.EXCEL,w.A.PDF]}}})}),(0,L.jsxs)(p.A,{open:Pe,onClose:()=>De(!1),children:[(0,L.jsx)(A.A,{children:"Export Geographic Data"}),(0,L.jsxs)(v.A,{children:[(0,L.jsx)(i.A,{variant:"body1",paragraph:!0,children:"Please confirm that you want to export the geographic data with the current filters."}),(0,L.jsxs)(c.A,{fullWidth:!0,sx:{mt:2},children:[(0,L.jsx)(d.A,{id:"export-format-label",children:"Export Format"}),(0,L.jsxs)(h.A,{labelId:"export-format-label",value:Fe,onChange:e=>Ie(e.target.value),label:"Export Format",children:[(0,L.jsx)(x.A,{value:"excel",children:"Excel"}),(0,L.jsx)(x.A,{value:"csv",children:"CSV"}),(0,L.jsx)(x.A,{value:"pdf",children:"PDF"})]})]})]}),(0,L.jsxs)(b.A,{children:[(0,L.jsx)(s.A,{onClick:()=>De(!1),children:"Cancel"}),(0,L.jsx)(s.A,{onClick:async()=>{try{Y(!0);const t={startDate:(0,C.A)(e,"yyyy-MM-dd"),endDate:(0,C.A)(a,"yyyy-MM-dd"),countryIds:O.length>0?O.map((e=>String(e))):void 0,whiteLabelIds:K.length>0?K.map((e=>String(e))):void 0,groupBy:T,...V},r=await k.A.geographic.exportData(t,Fe),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=`geographic-report-${(0,C.A)(new Date,"yyyy-MM-dd")}.${Fe}`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(n),document.body.removeChild(i),De(!1)}catch(t){console.error("[GEOGRAPHIC PAGE] Error exporting data:",t),te("Failed to export data. Please try again later.")}finally{Y(!1)}},variant:"contained",color:"primary",startIcon:(0,L.jsx)(F.A,{}),disabled:J,children:J?(0,L.jsx)(j.A,{size:24}):"Export"})]})]})]})}},86039:(e,t,a)=>{a.d(t,{eF:()=>w,ML:()=>G,LL:()=>C});a(65043);var r=a(85865),n=a(26240),i=a(81637),l=a(50108),s=a(877),o=a(87734),c=a(52185),d=a(6026),h=a(86150),x=a(21327),y=a(13839),u=a(82291),g=a(38643),m=a(87890),j=a(4240),p=a(17869),A=a(69525),v=a(70579);const b=["#0088FE","#00C49F","#FFBB28","#FF8042","#A569BD","#5DADE2","#48C9B0","#F4D03F"],f=e=>{let{active:t,payload:a,label:n}=e;return t&&a&&a.length?(0,v.jsxs)("div",{className:"custom-tooltip",style:{backgroundColor:"#fff",padding:"12px",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,v.jsx)(r.A,{variant:"subtitle2",style:{marginBottom:"8px"},children:n}),a.map(((e,t)=>{return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[(0,v.jsx)("span",{style:{width:"12px",height:"12px",backgroundColor:e.color,marginRight:"8px",borderRadius:"50%",display:"inline-block"}}),(0,v.jsxs)(r.A,{variant:"body2",color:"text.secondary",children:[e.name,": ",e.value>=1e3?(n=e.value,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(n)):(a=e.value,new Intl.NumberFormat("en-US").format(a))]})]},`item-${t}`);var a,n}))]}):null},w=e=>{let{data:t,xKey:a,yKeys:u,height:g=300,loading:m=!1,error:j=null,title:p,showLegend:w=!0,showGrid:G=!0}=e;const C=(0,n.A)();return m?(0,v.jsx)("div",{className:"chart-loading-container",style:{height:g},children:(0,v.jsx)(i.A,{})}):j?(0,v.jsx)("div",{className:"chart-error-container",style:{height:g},children:(0,v.jsx)(r.A,{color:"error",children:j})}):t&&0!==t.length?(0,v.jsxs)("div",{className:"chart-container",style:{width:"100%",height:g},children:[p&&(0,v.jsx)(r.A,{variant:"subtitle1",gutterBottom:!0,children:p}),(0,v.jsx)(l.u,{children:(0,v.jsxs)(s.Q,{data:t,margin:{top:10,right:30,left:0,bottom:0},children:[G&&(0,v.jsx)(o.d,{strokeDasharray:"3 3"}),(0,v.jsx)(c.W,{dataKey:a,tick:{fill:C.palette.text.secondary,fontSize:12},tickFormatter:e=>{try{if(!e)return"";if("string"===typeof e&&e.includes("T")){const t=new Date(e);return isNaN(t.getTime())?String(e):(0,A.A)(t,"MMM dd")}return String(e)}catch(j){return console.warn("Error formatting date:",j),String(e||"")}}}),(0,v.jsx)(d.h,{tick:{fill:C.palette.text.secondary,fontSize:12},tickFormatter:e=>e>=1e3?`${(e/1e3).toFixed(0)}k`:e}),(0,v.jsx)(h.m,{content:(0,v.jsx)(f,{})}),w&&(0,v.jsx)(x.s,{}),u.map(((e,t)=>(0,v.jsx)(y.G,{type:"monotone",dataKey:e,stroke:b[t%b.length],fill:b[t%b.length],fillOpacity:.3,name:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1")},e)))]})})]}):(0,v.jsx)("div",{className:"chart-empty-container",style:{height:g},children:(0,v.jsx)(r.A,{color:"text.secondary",children:"No data available"})})},G=e=>{let{data:t,xKey:a,yKeys:s,height:y=300,loading:m=!1,error:j=null,title:p,showLegend:w=!0,showGrid:G=!0,stacked:C=!1}=e;const S=(0,n.A)();return m?(0,v.jsx)("div",{className:"chart-loading-container",style:{height:y},children:(0,v.jsx)(i.A,{})}):j?(0,v.jsx)("div",{className:"chart-error-container",style:{height:y},children:(0,v.jsx)(r.A,{color:"error",children:j})}):t&&0!==t.length?(0,v.jsxs)("div",{className:"chart-container",style:{width:"100%",height:y},children:[p&&(0,v.jsx)(r.A,{variant:"subtitle1",gutterBottom:!0,children:p}),(0,v.jsx)(l.u,{children:(0,v.jsxs)(u.E,{data:t,margin:{top:10,right:30,left:0,bottom:0},children:[G&&(0,v.jsx)(o.d,{strokeDasharray:"3 3"}),(0,v.jsx)(c.W,{dataKey:a,tick:{fill:S.palette.text.secondary,fontSize:12},tickFormatter:e=>{try{if(!e)return"";if("string"===typeof e&&e.includes("T")){const t=new Date(e);return isNaN(t.getTime())?String(e):(0,A.A)(t,"MMM dd")}return String(e)}catch(j){return console.warn("Error formatting date:",j),String(e||"")}}}),(0,v.jsx)(d.h,{tick:{fill:S.palette.text.secondary,fontSize:12},tickFormatter:e=>e>=1e3?`${(e/1e3).toFixed(0)}k`:e}),(0,v.jsx)(h.m,{content:(0,v.jsx)(f,{})}),w&&(0,v.jsx)(x.s,{}),s.map(((e,t)=>(0,v.jsx)(g.y,{dataKey:e,fill:b[t%b.length],stackId:C?"stack":void 0,name:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1")},e)))]})})]}):(0,v.jsx)("div",{className:"chart-empty-container",style:{height:y},children:(0,v.jsx)(r.A,{color:"text.secondary",children:"No data available"})})},C=e=>{let{data:t,nameKey:a,valueKey:n,height:s=300,loading:o=!1,error:c=null,title:d,showLegend:y=!0}=e;return o?(0,v.jsx)("div",{className:"chart-loading-container",style:{height:s},children:(0,v.jsx)(i.A,{})}):c?(0,v.jsx)("div",{className:"chart-error-container",style:{height:s},children:(0,v.jsx)(r.A,{color:"error",children:c})}):t&&0!==t.length?(0,v.jsxs)("div",{className:"chart-container",style:{width:"100%",height:s},children:[d&&(0,v.jsx)(r.A,{variant:"subtitle1",gutterBottom:!0,children:d}),(0,v.jsx)(l.u,{children:(0,v.jsxs)(m.r,{children:[(0,v.jsx)(j.F,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:n,nameKey:a,label:e=>{let{name:t,percent:a}=e;return`${t}: ${(100*a).toFixed(0)}%`},children:t.map(((e,t)=>(0,v.jsx)(p.f,{fill:b[t%b.length]},`cell-${t}`)))}),y&&(0,v.jsx)(x.s,{}),(0,v.jsx)(h.m,{})]})})]}):(0,v.jsx)("div",{className:"chart-empty-container",style:{height:s},children:(0,v.jsx)(r.A,{color:"text.secondary",children:"No data available"})})}}}]);
//# sourceMappingURL=2407.78d45cde.chunk.js.map