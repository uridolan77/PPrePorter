"use strict";(self.webpackChunkppreporter_client=self.webpackChunkppreporter_client||[]).push([[1097],{6224:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var r=a(65043),l=a(19252),n=a(85865),i=a(63336),s=a(11906),o=a(8591),d=a(53193),c=a(18356),m=a(72221),g=a(32143),h=a(30279),A=a(39336),u=a(12110),x=a(26494),y=a(83462),p=a(4219),v=a(35316),j=a(29347),f=a(81637),E=a(88696),P=a(92317),b=a(352),C=a(69525),S=a(58390),R=a(40672),w=a(82746),F=a(28242),M=a(41132),D=a(21337),G=a(85473),N=a(85440),O=a(12807),B=a(70579);const k=()=>{const[e,t]=(0,r.useState)(new Date((new Date).setDate((new Date).getDate()-30))),[a,k]=(0,r.useState)(new Date),[I,V]=(0,r.useState)([]),[W,z]=(0,r.useState)([]),[Z,T]=(0,r.useState)([]),[H,L]=(0,r.useState)("day"),[U,$]=(0,r.useState)(!1),[_,q]=(0,r.useState)({}),[X,J]=(0,r.useState)([]),[K,Q]=(0,r.useState)(null),[Y,ee]=(0,r.useState)(!1),[te,ae]=(0,r.useState)(null),[re,le]=(0,r.useState)(0),[ne,ie]=(0,r.useState)([]),[se,oe]=(0,r.useState)([]),[de,ce]=(0,r.useState)([]),[me,ge]=(0,r.useState)(!1),[he,Ae]=(0,r.useState)(!1),[ue,xe]=(0,r.useState)(!1),[ye,pe]=(0,r.useState)([]),[ve,je]=(0,r.useState)([]),[fe,Ee]=(0,r.useState)([]),[Pe,be]=(0,r.useState)(0),[Ce,Se]=(0,r.useState)(10),[Re,we]=(0,r.useState)("date"),[Fe,Me]=(0,r.useState)("desc"),[De,Ge]=(0,r.useState)(!1),[Ne,Oe]=(0,r.useState)("excel");(0,r.useEffect)((()=>{(async()=>{try{console.log("[PERFORMANCE PAGE] Fetching metadata"),ge(!0),Ae(!0),xe(!0);const e=await N.A.performance.getMetadata();if(console.log("[PERFORMANCE PAGE] Got metadata from service:",e),e&&e.games){console.log("[PERFORMANCE PAGE] Got games from service:",e.games);const t=e.games||[];ie(t);const a=t.map((e=>({value:e.id,label:e.name})));pe(a)}else console.log("[PERFORMANCE PAGE] No games found in API response"),ie([]),pe([]);if(ge(!1),e&&e.gameCategories){console.log("[PERFORMANCE PAGE] Got categories from service:",e.gameCategories);const t=e.gameCategories||[];oe(t);const a=t.map((e=>({value:e.id,label:e.name})));je(a)}else console.log("[PERFORMANCE PAGE] No categories found in API response"),oe([]),je([]);if(Ae(!1),e&&e.gameProviders){console.log("[PERFORMANCE PAGE] Got providers from service:",e.gameProviders);const t=e.gameProviders||[];ce(t);const a=t.map((e=>({value:e.id,label:e.name})));Ee(a)}else console.log("[PERFORMANCE PAGE] No providers found in API response"),ce([]),Ee([]);xe(!1)}catch(e){console.error("[PERFORMANCE PAGE] Error fetching metadata:",e),ae("Failed to load metadata. Please try again later.")}})()}),[]),(0,r.useEffect)((()=>{const e=setTimeout((()=>{(async()=>{console.log("[PERFORMANCE PAGE] Fetching initial data"),await Be()})()}),100);return()=>clearTimeout(e)}),[]);const Be=async()=>{try{ee(!0),ae(null);const l={startDate:(0,C.A)(e,"yyyy-MM-dd"),endDate:(0,C.A)(a,"yyyy-MM-dd"),gameIds:I.length>0?I.map((e=>String(e))):void 0,gameCategories:W.length>0?W.map((e=>String(e))):void 0,gameProviders:Z.length>0?Z.map((e=>String(e))):void 0,groupBy:H,..._};console.log("[PERFORMANCE PAGE] Fetching data with filters:",l);const n={page:Pe+1,pageSize:Ce,sortBy:Re,sortDirection:Fe},i=await N.A.performance.getData({...l,...n});var t;if(i&&i.data)if(J(i.data),le((null===(t=i.meta)||void 0===t?void 0:t.totalCount)||i.data.length),i.summary)console.log("[PERFORMANCE PAGE] Using summary from response:",i.summary),Q(i.summary);else try{const e=await N.A.performance.getSummary(l);e&&Q(e)}catch(r){console.error("[PERFORMANCE PAGE] Error fetching summary:",r)}else console.log("[PERFORMANCE PAGE] No data returned from API"),J([]),Q(null),le(0)}catch(l){console.error("[PERFORMANCE PAGE] Error fetching data:",l),ae("Failed to load performance data. Please try again later."),J([]),Q(null),le(0)}finally{ee(!1)}},ke=[{id:"date",label:"Date",type:"date",align:"left",format:e=>e?(0,C.A)(new Date(e),"yyyy-MM-dd"):""},{id:"gameName",label:"Game",type:"text",align:"left"},{id:"gameCategory",label:"Category",type:"text",align:"left"},{id:"gameProvider",label:"Provider",type:"text",align:"left"},{id:"activePlayers",label:"Active Players",type:"number",align:"right",format:e=>(0,O.ZV)(e)},{id:"newPlayers",label:"New Players",type:"number",align:"right",format:e=>(0,O.ZV)(e)},{id:"sessions",label:"Sessions",type:"number",align:"right",format:e=>(0,O.ZV)(e)},{id:"avgSessionDuration",label:"Avg Session (min)",type:"number",align:"right",format:e=>(0,O.ZV)(e,1)},{id:"bets",label:"Bets",type:"number",align:"right",format:e=>(0,O.ZV)(e)},{id:"avgBet",label:"Avg Bet",type:"currency",align:"right",format:e=>(0,O.vv)(e)},{id:"wins",label:"Wins",type:"number",align:"right",format:e=>(0,O.ZV)(e)},{id:"avgWin",label:"Avg Win",type:"currency",align:"right",format:e=>(0,O.vv)(e)},{id:"winRate",label:"Win Rate",type:"percentage",align:"right",format:e=>(0,O.Ee)(e)},{id:"rtp",label:"RTP",type:"percentage",align:"right",format:e=>(0,O.Ee)(e)},{id:"holdPercentage",label:"Hold %",type:"percentage",align:"right",format:e=>(0,O.Ee)(e)}];return(0,B.jsxs)(l.A,{maxWidth:"xl",children:[(0,B.jsx)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,B.jsxs)("div",{children:[(0,B.jsx)(n.A,{variant:"h4",gutterBottom:!0,children:"Performance Report"}),(0,B.jsx)(n.A,{variant:"body1",color:"text.secondary",children:"View and analyze game performance, player activity, and engagement metrics"})]})}),(0,B.jsxs)(i.A,{sx:{p:3,mb:4},children:[(0,B.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,B.jsx)(n.A,{variant:"h6",children:"Filters"}),(0,B.jsxs)("div",{children:[(0,B.jsx)(s.A,{variant:"outlined",color:"primary",onClick:()=>$(!U),startIcon:U?(0,B.jsx)(G.A,{}):(0,B.jsx)(D.A,{}),sx:{mr:1},children:U?"Hide Advanced Filters":"Show Advanced Filters"}),(0,B.jsx)(s.A,{variant:"outlined",color:"secondary",onClick:()=>{t(new Date((new Date).setDate((new Date).getDate()-30))),k(new Date),V([]),z([]),T([]),L("day"),q({}),be(0),we("date"),Me("desc")},sx:{mr:1},children:"Reset"}),(0,B.jsx)(s.A,{variant:"contained",color:"primary",onClick:()=>{be(0),Be()},startIcon:(0,B.jsx)(F.A,{}),children:"Apply Filters"})]})]}),(0,B.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(S.$,{dateAdapter:R.h,children:(0,B.jsx)(w.l,{label:"Start Date",value:e,onChange:e=>e&&t(e),slotProps:{textField:{fullWidth:!0,variant:"outlined"}}})})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(S.$,{dateAdapter:R.h,children:(0,B.jsx)(w.l,{label:"End Date",value:a,onChange:e=>e&&k(e),slotProps:{textField:{fullWidth:!0,variant:"outlined"}}})})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsxs)(d.A,{fullWidth:!0,variant:"outlined",children:[(0,B.jsx)(c.A,{id:"group-by-label",children:"Group By"}),(0,B.jsxs)(m.A,{labelId:"group-by-label",value:H,onChange:e=>L(e.target.value),label:"Group By",children:[(0,B.jsx)(g.A,{value:"day",children:"Day"}),(0,B.jsx)(g.A,{value:"week",children:"Week"}),(0,B.jsx)(g.A,{value:"month",children:"Month"}),(0,B.jsx)(g.A,{value:"game",children:"Game"}),(0,B.jsx)(g.A,{value:"category",children:"Category"}),(0,B.jsx)(g.A,{value:"provider",children:"Provider"})]})]})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(b.A,{label:"Game Categories",options:ve,value:W,onChange:z,loading:he,fullWidth:!0})})]}),(0,B.jsx)(h.A,{in:U,children:(0,B.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,B.jsx)(A.A,{sx:{my:2}}),(0,B.jsx)(n.A,{variant:"subtitle1",gutterBottom:!0,children:"Advanced Filters"}),(0,B.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,B.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,B.jsx)(b.A,{label:"Games",options:ye,value:I,onChange:V,loading:me,fullWidth:!0})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,B.jsx)(b.A,{label:"Providers",options:fe,value:Z,onChange:T,loading:ue,fullWidth:!0})})]})]})})]}),K&&(0,B.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(u.A,{children:(0,B.jsxs)(x.A,{children:[(0,B.jsx)(n.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Active Players"}),(0,B.jsx)(n.A,{variant:"h5",children:(0,O.ZV)(K.totalActivePlayers)})]})})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(u.A,{children:(0,B.jsxs)(x.A,{children:[(0,B.jsx)(n.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Total Sessions"}),(0,B.jsx)(n.A,{variant:"h5",children:(0,O.ZV)(K.totalSessions)})]})})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(u.A,{children:(0,B.jsxs)(x.A,{children:[(0,B.jsx)(n.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Avg Session Duration"}),(0,B.jsxs)(n.A,{variant:"h5",children:[(0,O.ZV)(K.avgSessionDuration,1)," min"]})]})})}),(0,B.jsx)(o.Ay,{item:!0,xs:12,md:3,children:(0,B.jsx)(u.A,{children:(0,B.jsxs)(x.A,{children:[(0,B.jsx)(n.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Overall RTP"}),(0,B.jsx)(n.A,{variant:"h5",children:(0,O.Ee)(K.avgRTP)})]})})})]}),(0,B.jsx)(i.A,{sx:{p:0,mb:4,overflow:"hidden"},children:(0,B.jsx)(E.zZ,{columns:ke,data:X,loading:Y,title:"Performance Data",emptyMessage:"No performance data available",idField:"id",onExport:e=>{Oe(e),Ge(!0)},features:{sorting:!0,filtering:{enabled:!0,quickFilter:!0,advancedFilter:!0},pagination:{enabled:!0,defaultPageSize:Ce,pageSizeOptions:[10,25,50,100]},columnManagement:{enabled:!0,allowReordering:!0,allowHiding:!0,allowResizing:!0},export:{enabled:!0,formats:[P.A.CSV,P.A.EXCEL,P.A.PDF]}}})}),(0,B.jsxs)(y.A,{open:De,onClose:()=>Ge(!1),children:[(0,B.jsx)(p.A,{children:"Export Performance Data"}),(0,B.jsxs)(v.A,{children:[(0,B.jsx)(n.A,{variant:"body1",paragraph:!0,children:"Please confirm that you want to export the performance data with the current filters."}),(0,B.jsxs)(d.A,{fullWidth:!0,sx:{mt:2},children:[(0,B.jsx)(c.A,{id:"export-format-label",children:"Export Format"}),(0,B.jsxs)(m.A,{labelId:"export-format-label",value:Ne,onChange:e=>Oe(e.target.value),label:"Export Format",children:[(0,B.jsx)(g.A,{value:"excel",children:"Excel"}),(0,B.jsx)(g.A,{value:"csv",children:"CSV"}),(0,B.jsx)(g.A,{value:"pdf",children:"PDF"})]})]})]}),(0,B.jsxs)(j.A,{children:[(0,B.jsx)(s.A,{onClick:()=>Ge(!1),children:"Cancel"}),(0,B.jsx)(s.A,{onClick:async()=>{try{ee(!0);const t={startDate:(0,C.A)(e,"yyyy-MM-dd"),endDate:(0,C.A)(a,"yyyy-MM-dd"),gameIds:I.length>0?I.map((e=>String(e))):void 0,gameCategories:W.length>0?W.map((e=>String(e))):void 0,gameProviders:Z.length>0?Z.map((e=>String(e))):void 0,groupBy:H,..._},r=await N.A.performance.exportData(t,Ne),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download=`performance-report-${(0,C.A)(new Date,"yyyy-MM-dd")}.${Ne}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(l),document.body.removeChild(n),Ge(!1)}catch(t){console.error("[PERFORMANCE PAGE] Error exporting data:",t),ae("Failed to export data. Please try again later.")}finally{ee(!1)}},variant:"contained",color:"primary",startIcon:(0,B.jsx)(M.A,{}),disabled:Y,children:Y?(0,B.jsx)(f.A,{size:24}):"Export"})]})]})]})}},41132:(e,t,a)=>{var r=a(24994);t.A=void 0;var l=r(a(40039)),n=a(70579);t.A=(0,l.default)((0,n.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")},47030:(e,t,a)=>{var r=a(24994);t.A=void 0;var l=r(a(40039)),n=a(70579);t.A=(0,l.default)((0,n.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined")}}]);
//# sourceMappingURL=1097.02edb901.chunk.js.map